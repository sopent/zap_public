{"openapi": "3.0.2", "info": {"title": "FastAPI", "description": "Использование имеющихся сервисов 1С:\n<ul>\n     <li>1. Загрузка прайсов от поставщиков. Можно оставить парсинг прайсов поставщикам в виде программы на Delphi, однако нужно формировать текстовые файлы и отдавать их сайту для загрузки.</li>\n     <li>2. Отправка прайсов клиентам. Можно оставить в 1С, пока это устраивает по функционалу и производительности.</li>\n     <li>3. Парсинг заказов от клиентов. Можно оставить в 1С, но необходимо передавать данные на сайт по апи (/order/add).</li>\n     <li>4. Отправка заказов поставщикам. Можно сделать там, где удобнее дорабатывать и расширять (/order/to-supplier).</li>\n     <li>5. Парсинг инвойсов. В будущем должен быть автоматический, f1pro такого не предоставляет, однако временно оставляем в 1С, передаем данные на сайт (/order/supplier-invoice)</li>\n     <li>A. Дополнительный вопрос по документам. Их может генерировать 1С и отдавать сайту через веб-сервис или ssh. При этом нужно от 1С получать состав возвратного документа (/client/return-doc).</li>\n</ul>     \n     ", "version": "0.1.0"}, "paths": {"/": {"get": {"summary": "Index", "operationId": "index__get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/client/create": {"post": {"tags": ["1C"], "summary": "передача в 1с новых пользователей", "description": "сайт передает в это апи новых пользователей\n(client.data_fetched_by_1c=DATA_NEW, выставляется DATA_FETCHED)", "operationId": "client_create_client_create_post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/Client"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/supplier/get-new": {"get": {"tags": ["disabled"], "summary": "передача в 1с новых поставщиков, пакетно", "description": "1c обращается к этому апи, что бы забрать новых поставщиков, необходима новая колонка в базе,\nлибо 1с передает диапазон дат и фильтрация по date_changed\n(supplier.data_fetched_by_1c=DATA_NEW, выставляется DATA_FETCHED)", "operationId": "supplier_get_new_supplier_get_new_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/user/get-updated": {"get": {"tags": ["disabled"], "summary": "передача в 1с обновлений данных по пользователям, пакетно", "description": "1c обращается к этому апи, что бы забрать обновленные данные пользователей\n(client.data_fetched_by_1c=DATA_UPDATED, выставляется DATA_FETCHED)", "operationId": "user_get_updated_user_get_updated_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/supplier/get-updated": {"get": {"tags": ["disabled"], "summary": "передача в 1с обновления данных по поставщикам, пакетно", "description": "1c обращается к этому апи, что бы забрать обновленные данные поставщиков, необходима новая колонка в базе\n(supplier.data_fetched_by_1c=DATA_UPDATED, выставляется DATA_FETCHED)", "operationId": "supplier_get_updated_supplier_get_updated_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/create": {"post": {"tags": ["1C"], "summary": "передача заказов в 1С", "description": "Т.к. есть заказы через сайт, а не только почтовые, это апи обязательно нужно, что бы передать в 1С состав этих заказов", "operationId": "order_create_order_create_post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/Order"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/order/add": {"post": {"tags": ["disabled"], "summary": "передача заказов на сайт из 1С", "description": "Если почтовые заказы будет парсить 1С, то она должна отдать результат на сайт, что бы отображать данные клиентам\nи заполнять client_invoice", "operationId": "order_add_order_add_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/to-supplier": {"post": {"tags": ["disabled"], "summary": "заказы поставщикам", "description": "Если заказы поставщикам отправляет 1С, то этот метод принимает данные. Если отправлять будет сайт,\nто он отдает данные для 1С. Нужно выбрать.", "operationId": "order_to_supplier_order_to_supplier_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/supplier-invoice": {"post": {"tags": ["disabled"], "summary": "загрузка инвойса от поставщика из 1С на сайт", "description": "Если инвойсы загружаются через 1С, то через этот сервис передается состав документа для заполнения supplier_invoice", "operationId": "order_supplier_invoice_order_supplier_invoice_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/change-status": {"post": {"tags": ["site"], "summary": "пакетная отправка статусов, например пришло, выдано, возврат, отказ", "description": "Отправка статусов от склада на сайт - пришло, выдано, возврат, отказ поставщика. Отказ поставщика отправляется,\nнапример, в случае, если с поставщиком договоренность - не привёз на следующий день, уже не привезёт.\nВозврат в этом сервисе необязательно, можно запретить этот статус тут, т.к. есть /client/return-doc\nИсходный статус нужен для предотвращения ошибок, переходы проверяются машиной состояний. partsticker_id есть не всегда, поэтому нужен order_id.", "operationId": "order_change_status_by_key_order_change_status_post", "requestBody": {"content": {"application/json": {"schema": {"title": "Statuses", "type": "array", "items": {"$ref": "#/components/schemas/ChangeStatus"}}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/order/change-price": {"post": {"tags": ["disabled"], "summary": "изменение цены заказа", "description": "В случае изменения цены в 1С", "operationId": "order_change_price_order_change_price_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/reject": {"get": {"tags": ["disabled"], "summary": "детали, уже не нужные клиентам", "description": "Список деталей, которые склад должен сразу отправить на возврат поставщику, не собирая их клиентам.\nНе приоритетно.", "operationId": "order_reject_order_reject_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/client/return-doc": {"get": {"tags": ["disabled"], "summary": "состав документа возврата клиенту", "description": "состав возвратных документов клиента, для заполнения order_status.invoice_return_number", "operationId": "client_return_doc_client_return_doc_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/reject-approved": {"get": {"tags": ["disabled"], "summary": "одобрение возвратов", "description": "Синхронизация данных об одобренных возвратах, направление передачи данных зависит от выбранной схемы работы с возвратами", "operationId": "client_return_doc_order_reject_approved_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}}, "components": {"schemas": {"ChangeStatus": {"title": "ChangeStatus", "required": ["orderId", "statusFrom", "statusTo", "partstickerId", "quantity"], "type": "object", "properties": {"orderId": {"title": "Orderid", "type": "integer"}, "statusFrom": {"$ref": "#/components/schemas/Status"}, "statusTo": {"$ref": "#/components/schemas/Status"}, "partstickerId": {"title": "Partstickerid", "type": "integer"}, "quantity": {"title": "Quantity", "type": "integer"}}}, "Client": {"title": "Client", "required": ["ClientId", "OfficeId", "Login", "FirstName", "LastName", "Patronymic", "Phone1", "Phone2", "Phone1Addit", "Phone2Addit", "Email1", "Email2", "UrikName", "UrikInn", "UrikKpp", "UrikOkpo", "UrikBankName", "UrikBankCorrAccount", "UrikBankAccount", "UrikBankBik", "UrikOgrn", "LegalEntityType", "DateReg", "PayNds", "MethodPaymentType", "BuhPosition", "BuhLastName", "BuhFirstName", "BuhPatronymic", "BuhEmail", "BuhPhone", "BuhPhoneAddit", "DirectorLastName", "DirectorFirstName", "DirectorPatronymic", "DirectorEmail", "DirectorPhone", "DirectorPhoneAddit", "ManagerLastName", "ManagerFirstName", "ManagerPatronymic", "ManagerEmail", "ManagerPhone", "ManagerPhoneAddit", "ActualAddressPostcode", "ActualAddressCountry", "ActualAddressRegion", "ActualAddressCity", "ActualAddressstreet", "ActualAddressHouse", "ActualAddressHousing", "ActualAddressstructure", "ActualAddressEntrance", "ActualAddressFloor", "ActualAddressOffice", "ActualAddressLat", "ActualAddressLong", "ActualAddressComment", "UrikAddressPostcode", "UrikAddressCountry", "UrikAddressRegion", "UrikAddressCity", "UrikAddressstreet", "UrikAddressHouse", "UrikAddressHousing", "UrikAddressstructure", "UrikAddressEntrance", "UrikAddressFloor", "UrikAddressOffice", "UrikAddressLat", "UrikAddressLong", "UrikAddressComment", "Comment", "AllowTireSell"], "type": "object", "properties": {"ClientId": {"title": "Clientid", "type": "integer"}, "OfficeId": {"title": "Officeid", "type": "integer"}, "Login": {"title": "Login", "type": "string"}, "FirstName": {"title": "Firstname", "type": "string"}, "LastName": {"title": "Lastname", "type": "string"}, "Patronymic": {"title": "Patronymic", "type": "string"}, "Phone1": {"title": "Phone1", "type": "string"}, "Phone2": {"title": "Phone2", "type": "string"}, "Phone1Addit": {"title": "Phone1Addit", "type": "string"}, "Phone2Addit": {"title": "Phone2Addit", "type": "string"}, "Email1": {"title": "Email1", "type": "string"}, "Email2": {"title": "Email2", "type": "string"}, "UrikName": {"title": "Urikname", "type": "string"}, "UrikInn": {"title": "Urikinn", "type": "string"}, "UrikKpp": {"title": "Urikkpp", "type": "string"}, "UrikOkpo": {"title": "Urikokpo", "type": "string"}, "UrikBankName": {"title": "Urikbankname", "type": "string"}, "UrikBankCorrAccount": {"title": "Urikbankcorraccount", "type": "string"}, "UrikBankAccount": {"title": "Urikbankaccount", "type": "string"}, "UrikBankBik": {"title": "Urikbankbik", "type": "string"}, "UrikOgrn": {"title": "Urikogrn", "type": "string"}, "LegalEntityType": {"$ref": "#/components/schemas/LegalEntityType"}, "DateReg": {"title": "Datereg", "type": "string"}, "PayNds": {"title": "Paynds", "type": "boolean"}, "MethodPaymentType": {"allOf": [{"$ref": "#/components/schemas/MethodPaymentType"}], "description": "0/1 - Наличные/безнал"}, "BuhPosition": {"title": "Buhposition", "type": "string"}, "BuhLastName": {"title": "Buhlastname", "type": "string"}, "BuhFirstName": {"title": "Buhfirstname", "type": "string"}, "BuhPatronymic": {"title": "Buhpatronymic", "type": "string"}, "BuhEmail": {"title": "Buhemail", "type": "string"}, "BuhPhone": {"title": "Buhphone", "type": "string"}, "BuhPhoneAddit": {"title": "Buhphoneaddit", "type": "string"}, "DirectorLastName": {"title": "Directorlastname", "type": "string"}, "DirectorFirstName": {"title": "Directorfirstname", "type": "string"}, "DirectorPatronymic": {"title": "Directorpatronymic", "type": "string"}, "DirectorEmail": {"title": "Directoremail", "type": "string"}, "DirectorPhone": {"title": "Directorphone", "type": "string"}, "DirectorPhoneAddit": {"title": "Directorphoneaddit", "type": "string"}, "ManagerLastName": {"title": "Managerlastname", "type": "string"}, "ManagerFirstName": {"title": "Managerfirstname", "type": "string"}, "ManagerPatronymic": {"title": "Managerpatronymic", "type": "string"}, "ManagerEmail": {"title": "Manageremail", "type": "string"}, "ManagerPhone": {"title": "Managerphone", "type": "string"}, "ManagerPhoneAddit": {"title": "Managerphoneaddit", "type": "string"}, "ActualAddressPostcode": {"title": "Actualaddresspostcode", "type": "string"}, "ActualAddressCountry": {"title": "Actualaddresscountry", "type": "string"}, "ActualAddressRegion": {"title": "Actualaddressregion", "type": "string"}, "ActualAddressCity": {"title": "Actualaddresscity", "type": "string"}, "ActualAddressstreet": {"title": "Actualaddressstreet", "type": "string"}, "ActualAddressHouse": {"title": "Actualaddresshouse", "type": "string"}, "ActualAddressHousing": {"title": "Actualaddresshousing", "type": "string"}, "ActualAddressstructure": {"title": "Actualaddressstructure", "type": "string"}, "ActualAddressEntrance": {"title": "Actualaddressentrance", "type": "string"}, "ActualAddressFloor": {"title": "Actualaddressfloor", "type": "string"}, "ActualAddressOffice": {"title": "Actualaddressoffice", "type": "string"}, "ActualAddressLat": {"title": "Actualaddresslat", "type": "string"}, "ActualAddressLong": {"title": "Actualaddresslong", "type": "string"}, "ActualAddressComment": {"title": "Actualaddresscomment", "type": "string"}, "UrikAddressPostcode": {"title": "Urikaddresspostcode", "type": "string"}, "UrikAddressCountry": {"title": "Urikaddresscountry", "type": "string"}, "UrikAddressRegion": {"title": "Urikaddressregion", "type": "string"}, "UrikAddressCity": {"title": "Urikaddresscity", "type": "string"}, "UrikAddressstreet": {"title": "Urikaddressstreet", "type": "string"}, "UrikAddressHouse": {"title": "Urikaddresshouse", "type": "string"}, "UrikAddressHousing": {"title": "Urikaddresshousing", "type": "string"}, "UrikAddressstructure": {"title": "Urikaddressstructure", "type": "string"}, "UrikAddressEntrance": {"title": "Urikaddressentrance", "type": "string"}, "UrikAddressFloor": {"title": "Urikaddressfloor", "type": "string"}, "UrikAddressOffice": {"title": "Urikaddressoffice", "type": "string"}, "UrikAddressLat": {"title": "Urikaddresslat", "type": "string"}, "UrikAddressLong": {"title": "Urikaddresslong", "type": "string"}, "UrikAddressComment": {"title": "Urikaddresscomment", "type": "string"}, "Comment": {"title": "Comment", "type": "string"}, "AllowTireSell": {"title": "Allowtiresell", "type": "boolean"}}}, "HTTPValidationError": {"title": "HTTPValidationError", "type": "object", "properties": {"detail": {"title": "Detail", "type": "array", "items": {"$ref": "#/components/schemas/ValidationError"}}}}, "LegalEntityType": {"title": "LegalEntityType", "enum": ["ИП", "ООО", "АО", "Частное лицо"], "type": "string", "description": "An enumeration."}, "MethodPaymentType": {"title": "MethodPaymentType", "enum": [0, 1], "type": "integer", "description": "An enumeration."}, "Order": {"title": "Order", "required": ["OrderId", "ClientId", "SubclientLogin", "DetailNum", "MakeName", "SupplierLogo", "Direction", "PriceSupplier", "PriceClient", "Quantity", "Description", "DateOrder", "NumberOrder", "Reference", "Gtd"], "type": "object", "properties": {"OrderId": {"title": "Orderid", "type": "integer"}, "ClientId": {"title": "Clientid", "type": "integer"}, "SubclientLogin": {"title": "Subclientlogin", "type": "string"}, "DetailNum": {"title": "Detailnum", "type": "string"}, "MakeName": {"title": "Makename", "type": "string"}, "SupplierLogo": {"title": "Supplierlogo", "type": "string", "description": "from supplier.login"}, "Direction": {"title": "Direction", "type": "string", "description": "from supplier_direction.direction"}, "PriceSupplier": {"title": "Pricesupplier", "type": "number"}, "PriceClient": {"title": "Priceclient", "type": "number"}, "Quantity": {"title": "Quantity", "type": "integer"}, "Description": {"title": "Description", "type": "string"}, "DateOrder": {"title": "Dateorder", "type": "string", "format": "date-time"}, "NumberOrder": {"title": "Numberorder", "type": "string"}, "Reference": {"title": "Reference", "type": "string"}, "Gtd": {"title": "Gtd", "type": "string", "description": "получается из инвойсов, при парсинге инвойсов на стороне сайта необходимо добавить такое поле в orders_status и передавать здесь, пока пустая строка"}}}, "Status": {"title": "Status", "enum": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "type": "integer", "description": "An enumeration."}, "ValidationError": {"title": "ValidationError", "required": ["loc", "msg", "type"], "type": "object", "properties": {"loc": {"title": "Location", "type": "array", "items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}}, "msg": {"title": "Message", "type": "string"}, "type": {"title": "Error Type", "type": "string"}}}}}, "tags": [{"name": "1C", "description": "Сервисы на стороне 1С, согласованные для разработки"}, {"name": "site", "description": "Сервисы на стороне сайта, согласованные для разработки"}, {"name": "disabled", "description": "Потенциально полезные сервисы"}]}