{"openapi": "3.0.2", "info": {"title": "FastAPI", "description": "Использование имеющихся сервисов 1С:\n<ul>\n     <li>1. Загрузка прайсов от поставщиков. Можно оставить парсинг прайсов поставщикам в виде программы на Delphi, однако нужно формировать текстовые файлы и отдавать их сайту для загрузки.</li>\n     <li>2. Отправка прайсов клиентам. Можно оставить в 1С, пока это устраивает по функционалу и производительности.</li>\n     <li>3. Парсинг заказов от клиентов. Можно оставить в 1С, но необходимо передавать данные на сайт по апи (/order/add).</li>\n     <li>4. Отправка заказов поставщикам. Можно сделать там, где удобнее дорабатывать и расширять (/order/to-supplier).</li>\n     <li>5. Парсинг инвойсов. В будущем должен быть автоматический, f1pro такого не предоставляет, однако временно оставляем в 1С, передаем данные на сайт (/order/supplier-invoice)</li>\n     <li>A. Дополнительный вопрос по документам. Их может генерировать 1С и отдавать сайту через веб-сервис или ssh. При этом нужно от 1С получать состав возвратного документа (/client/return-doc).</li>\n</ul>     \n     ", "version": "0.1.0"}, "paths": {"/": {"get": {"summary": "Index", "operationId": "index__get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/client/create": {"post": {"tags": ["1C"], "summary": "передача в 1с новых пользователей", "description": "сайт передает в это апи новых пользователей\n(client.data_fetched_by_1c=DATA_NEW, выставляется DATA_FETCHED)", "operationId": "client_create_client_create_post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/Client"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/supplier/get-new": {"get": {"tags": ["disabled"], "summary": "передача в 1с новых поставщиков, пакетно", "description": "1c обращается к этому апи, что бы забрать новых поставщиков, необходима новая колонка в базе,\nлибо 1с передает диапазон дат и фильтрация по date_changed\n(supplier.data_fetched_by_1c=DATA_NEW, выставляется DATA_FETCHED)", "operationId": "supplier_get_new_supplier_get_new_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/user/get-updated": {"get": {"tags": ["disabled"], "summary": "передача в 1с обновлений данных по пользователям, пакетно", "description": "1c обращается к этому апи, что бы забрать обновленные данные пользователей\n(client.data_fetched_by_1c=DATA_UPDATED, выставляется DATA_FETCHED)", "operationId": "user_get_updated_user_get_updated_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/supplier/get-updated": {"get": {"tags": ["disabled"], "summary": "передача в 1с обновления данных по поставщикам, пакетно", "description": "1c обращается к этому апи, что бы забрать обновленные данные поставщиков, необходима новая колонка в базе\n(supplier.data_fetched_by_1c=DATA_UPDATED, выставляется DATA_FETCHED)", "operationId": "supplier_get_updated_supplier_get_updated_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/create": {"post": {"tags": ["1C"], "summary": "передача заказов в 1С", "description": "Т.к. есть заказы через сайт, а не только почтовые, это апи обязательно нужно, что бы передать в 1С состав этих заказов", "operationId": "order_create_order_create_post", "requestBody": {"content": {"application/json": {"schema": {"$ref": "#/components/schemas/Order"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/order/add": {"post": {"tags": ["disabled"], "summary": "передача заказов на сайт из 1С", "description": "Если почтовые заказы будет парсить 1С, то она должна отдать результат на сайт, что бы отображать данные клиентам\nи заполнять client_invoice", "operationId": "order_add_order_add_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/to-supplier": {"post": {"tags": ["disabled"], "summary": "заказы поставщикам", "description": "Если заказы поставщикам отправляет 1С, то этот метод принимает данные. Если отправлять будет сайт,\nто он отдает данные для 1С. Нужно выбрать.", "operationId": "order_to_supplier_order_to_supplier_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/supplier-invoice": {"post": {"tags": ["disabled"], "summary": "загрузка инвойса от поставщика из 1С на сайт", "description": "Если инвойсы загружаются через 1С, то через этот сервис передается состав документа для заполнения supplier_invoice", "operationId": "order_supplier_invoice_order_supplier_invoice_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/change-status": {"post": {"tags": ["site"], "summary": "пакетная отправка статусов, например пришло, выдано, возврат, отказ", "description": "Отправка статусов от склада на сайт - пришло, выдано, возврат, отказ поставщика. Отказ поставщика отправляется,\nнапример, в случае, если с поставщиком договоренность - не привёз на следующий день, уже не привезёт.\nВозврат в этом сервисе необязательно, можно запретить этот статус тут, т.к. есть /client/return-doc\nИсходный статус нужен для предотвращения ошибок, переходы проверяются машиной состояний. partsticker_id есть не всегда, поэтому нужен order_id.", "operationId": "order_change_status_by_key_order_change_status_post", "requestBody": {"content": {"application/json": {"schema": {"title": "Statuses", "type": "array", "items": {"$ref": "#/components/schemas/ChangeStatus"}}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/order/change-price": {"post": {"tags": ["disabled"], "summary": "изменение цены заказа", "description": "В случае изменения цены в 1С", "operationId": "order_change_price_order_change_price_post", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/reject": {"get": {"tags": ["disabled"], "summary": "детали, уже не нужные клиентам", "description": "Список деталей, которые склад должен сразу отправить на возврат поставщику, не собирая их клиентам.\nНе приоритетно.", "operationId": "order_reject_order_reject_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/client/return-doc": {"get": {"tags": ["disabled"], "summary": "состав документа возврата клиенту", "description": "состав возвратных документов клиента, для заполнения order_status.invoice_return_number", "operationId": "client_return_doc_client_return_doc_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}, "/order/reject-approved": {"get": {"tags": ["disabled"], "summary": "одобрение возвратов", "description": "Синхронизация данных об одобренных возвратах, направление передачи данных зависит от выбранной схемы работы с возвратами", "operationId": "client_return_doc_order_reject_approved_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}}}}}, "components": {"schemas": {"ChangeStatus": {"title": "ChangeStatus", "required": ["order_id", "status_from", "status_to", "partsticker_id", "quantity"], "type": "object", "properties": {"order_id": {"title": "Order Id", "type": "integer"}, "status_from": {"$ref": "#/components/schemas/Status"}, "status_to": {"$ref": "#/components/schemas/Status"}, "partsticker_id": {"title": "Partsticker Id", "type": "integer"}, "quantity": {"title": "Quantity", "type": "integer"}}}, "Client": {"title": "Client", "required": ["client_id", "office_id", "login", "first_name", "last_name", "patronymic", "phone1", "phone2", "phone1_addit", "phone2_addit", "email1", "email2", "urik_name", "urik_inn", "urik_kpp", "urik_okpo", "urik_bank_name", "urik_bank_corr_account", "urik_bank_account", "urik_bank_bik", "urik_ogrn", "legal_entity_type", "date_reg", "pay_nds", "method_payment_type", "buh_position", "buh_last_name", "buh_first_name", "buh_patronymic", "buh_email", "buh_phone", "buh_phone_addit", "director_last_name", "director_first_name", "director_patronymic", "director_email", "director_phone", "director_phone_addit", "manager_last_name", "manager_first_name", "manager_patronymic", "manager_email", "manager_phone", "manager_phone_addit", "actual_address_postcode", "actual_address_country", "actual_address_region", "actual_address_city", "actual_address_street", "actual_address_house", "actual_address_housing", "actual_address_structure", "actual_address_entrance", "actual_address_floor", "actual_address_office", "actual_address_lat", "actual_address_long", "actual_address_comment", "urik_address_postcode", "urik_address_country", "urik_address_region", "urik_address_city", "urik_address_street", "urik_address_house", "urik_address_housing", "urik_address_structure", "urik_address_entrance", "urik_address_floor", "urik_address_office", "urik_address_lat", "urik_address_long", "urik_address_comment", "comment", "allow_tire_sell"], "type": "object", "properties": {"client_id": {"title": "Client Id", "type": "integer"}, "office_id": {"title": "Office Id", "type": "integer"}, "login": {"title": "Login", "type": "string"}, "first_name": {"title": "First Name", "type": "string"}, "last_name": {"title": "Last Name", "type": "string"}, "patronymic": {"title": "Patronymic", "type": "string"}, "phone1": {"title": "Phone1", "type": "string"}, "phone2": {"title": "Phone2", "type": "string"}, "phone1_addit": {"title": "Phone1 Addit", "type": "string"}, "phone2_addit": {"title": "Phone2 Addit", "type": "string"}, "email1": {"title": "Email1", "type": "string"}, "email2": {"title": "Email2", "type": "string"}, "urik_name": {"title": "Urik Name", "type": "string"}, "urik_inn": {"title": "Urik Inn", "type": "string"}, "urik_kpp": {"title": "Urik Kpp", "type": "string"}, "urik_okpo": {"title": "Urik Okpo", "type": "string"}, "urik_bank_name": {"title": "Urik Bank Name", "type": "string"}, "urik_bank_corr_account": {"title": "Urik Bank Corr Account", "type": "string"}, "urik_bank_account": {"title": "Urik Bank Account", "type": "string"}, "urik_bank_bik": {"title": "Urik Bank Bik", "type": "string"}, "urik_ogrn": {"title": "Urik Ogrn", "type": "string"}, "legal_entity_type": {"$ref": "#/components/schemas/LegalEntityType"}, "date_reg": {"title": "Date Reg", "type": "string"}, "pay_nds": {"title": "Pay Nds", "type": "boolean"}, "method_payment_type": {"$ref": "#/components/schemas/MethodPaymentType"}, "buh_position": {"title": "Buh Position", "type": "string"}, "buh_last_name": {"title": "Buh Last Name", "type": "string"}, "buh_first_name": {"title": "Buh First Name", "type": "string"}, "buh_patronymic": {"title": "Buh Patronymic", "type": "string"}, "buh_email": {"title": "Buh Email", "type": "string"}, "buh_phone": {"title": "Buh Phone", "type": "string"}, "buh_phone_addit": {"title": "Buh Phone Addit", "type": "string"}, "director_last_name": {"title": "Director Last Name", "type": "string"}, "director_first_name": {"title": "Director First Name", "type": "string"}, "director_patronymic": {"title": "Director Patronymic", "type": "string"}, "director_email": {"title": "Director Email", "type": "string"}, "director_phone": {"title": "Director Phone", "type": "string"}, "director_phone_addit": {"title": "Director Phone Addit", "type": "string"}, "manager_last_name": {"title": "Manager Last Name", "type": "string"}, "manager_first_name": {"title": "Manager First Name", "type": "string"}, "manager_patronymic": {"title": "Manager Patronymic", "type": "string"}, "manager_email": {"title": "Manager Email", "type": "string"}, "manager_phone": {"title": "Manager Phone", "type": "string"}, "manager_phone_addit": {"title": "Manager Phone Addit", "type": "string"}, "actual_address_postcode": {"title": "Actual Address Postcode", "type": "string"}, "actual_address_country": {"title": "Actual Address Country", "type": "string"}, "actual_address_region": {"title": "Actual Address Region", "type": "string"}, "actual_address_city": {"title": "Actual Address City", "type": "string"}, "actual_address_street": {"title": "Actual Address Street", "type": "string"}, "actual_address_house": {"title": "Actual Address House", "type": "string"}, "actual_address_housing": {"title": "Actual Address Housing", "type": "string"}, "actual_address_structure": {"title": "Actual Address Structure", "type": "string"}, "actual_address_entrance": {"title": "Actual Address Entrance", "type": "string"}, "actual_address_floor": {"title": "Actual Address Floor", "type": "string"}, "actual_address_office": {"title": "Actual Address Office", "type": "string"}, "actual_address_lat": {"title": "Actual Address Lat", "type": "string"}, "actual_address_long": {"title": "Actual Address Long", "type": "string"}, "actual_address_comment": {"title": "Actual Address Comment", "type": "string"}, "urik_address_postcode": {"title": "Urik Address Postcode", "type": "string"}, "urik_address_country": {"title": "Urik Address Country", "type": "string"}, "urik_address_region": {"title": "Urik Address Region", "type": "string"}, "urik_address_city": {"title": "Urik Address City", "type": "string"}, "urik_address_street": {"title": "Urik Address Street", "type": "string"}, "urik_address_house": {"title": "Urik Address House", "type": "string"}, "urik_address_housing": {"title": "Urik Address Housing", "type": "string"}, "urik_address_structure": {"title": "Urik Address Structure", "type": "string"}, "urik_address_entrance": {"title": "Urik Address Entrance", "type": "string"}, "urik_address_floor": {"title": "Urik Address Floor", "type": "string"}, "urik_address_office": {"title": "Urik Address Office", "type": "string"}, "urik_address_lat": {"title": "Urik Address Lat", "type": "string"}, "urik_address_long": {"title": "Urik Address Long", "type": "string"}, "urik_address_comment": {"title": "Urik Address Comment", "type": "string"}, "comment": {"title": "Comment", "type": "string"}, "allow_tire_sell": {"title": "Allow Tire Sell", "type": "boolean"}}}, "HTTPValidationError": {"title": "HTTPValidationError", "type": "object", "properties": {"detail": {"title": "Detail", "type": "array", "items": {"$ref": "#/components/schemas/ValidationError"}}}}, "LegalEntityType": {"title": "LegalEntityType", "enum": ["ИП", "ООО", "АО", "Частное лицо"], "type": "string", "description": "An enumeration."}, "MethodPaymentType": {"title": "MethodPaymentType", "enum": ["0", "1"], "type": "string", "description": "An enumeration."}, "Order": {"title": "Order", "required": ["order_id", "client_id", "subclient_login", "detail_num", "make_name", "supplier_logo", "direction", "price_supplier", "price_client", "quantity", "description", "date_order", "number_order", "reference", "gtd"], "type": "object", "properties": {"order_id": {"title": "Order Id", "type": "integer"}, "client_id": {"title": "Client Id", "type": "integer"}, "subclient_login": {"title": "Subclient Login", "type": "string"}, "detail_num": {"title": "Detail Num", "type": "string"}, "make_name": {"title": "Make Name", "type": "string"}, "supplier_logo": {"title": "Supplier Logo", "type": "string", "descrition": "from supplier.login"}, "direction": {"title": "Direction", "type": "string", "descrition": "from supplier_direction.direction"}, "price_supplier": {"title": "Price Supplier", "type": "number"}, "price_client": {"title": "Price Client", "type": "number"}, "quantity": {"title": "Quantity", "type": "integer"}, "description": {"title": "Description", "type": "string"}, "date_order": {"title": "Date Order", "type": "string", "format": "date-time"}, "number_order": {"title": "Number Order", "type": "string"}, "reference": {"title": "Reference", "type": "string"}, "gtd": {"title": "Gtd", "type": "string", "descrition": "получается из инвойсов, при парсинге инвойсов на стороне сайта необходимо добавить такое поле в orders_status и передавать здесь, пока пустая строка"}}}, "Status": {"title": "Status", "enum": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "type": "integer", "description": "An enumeration."}, "ValidationError": {"title": "ValidationError", "required": ["loc", "msg", "type"], "type": "object", "properties": {"loc": {"title": "Location", "type": "array", "items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}}, "msg": {"title": "Message", "type": "string"}, "type": {"title": "Error Type", "type": "string"}}}}}, "tags": [{"name": "1C", "description": "Сервисы на стороне 1С, согласованные для разработки"}, {"name": "site", "description": "Сервисы на стороне сайта, согласованные для разработки"}, {"name": "disabled", "description": "Потенциально полезные сервисы"}]}